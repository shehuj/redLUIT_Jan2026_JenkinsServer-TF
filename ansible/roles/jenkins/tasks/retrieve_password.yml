---
- name: Wait for initial admin password file
  ansible.builtin.wait_for:
    path: /var/lib/jenkins/secrets/initialAdminPassword
    timeout: 300

- name: Retrieve Jenkins initial admin password
  ansible.builtin.slurp:
    src: /var/lib/jenkins/secrets/initialAdminPassword
  register: jenkins_initial_password

- name: Decode and set password fact
  ansible.builtin.set_fact:
    jenkins_admin_password: "{{ jenkins_initial_password.content | b64decode | trim }}"

- name: Display Jenkins access information
  ansible.builtin.debug:
    msg:
      - "================================================"
      - "Jenkins URL: http://{{ ansible_host }}:8080"
      - "Username: admin"
      - "Initial Password: {{ jenkins_admin_password }}"
      - "================================================"
